<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis | Human0722&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="Just a tech, fuck u SEO">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.f289ed6e.css" as="style"><link rel="preload" href="/assets/js/app.1aae9113.js" as="script"><link rel="preload" href="/assets/js/2.7e1b7c98.js" as="script"><link rel="preload" href="/assets/js/48.dffc62f2.js" as="script"><link rel="prefetch" href="/assets/js/10.3445023b.js"><link rel="prefetch" href="/assets/js/11.3e7d9489.js"><link rel="prefetch" href="/assets/js/12.0d1b7ed5.js"><link rel="prefetch" href="/assets/js/13.7a61b2f2.js"><link rel="prefetch" href="/assets/js/14.b20c1fc5.js"><link rel="prefetch" href="/assets/js/15.83a88337.js"><link rel="prefetch" href="/assets/js/16.1ca3ce17.js"><link rel="prefetch" href="/assets/js/17.a9de19f2.js"><link rel="prefetch" href="/assets/js/18.6c4995d8.js"><link rel="prefetch" href="/assets/js/19.6def3249.js"><link rel="prefetch" href="/assets/js/20.c31a527d.js"><link rel="prefetch" href="/assets/js/21.9319f3ae.js"><link rel="prefetch" href="/assets/js/22.06bbb27e.js"><link rel="prefetch" href="/assets/js/23.7eb77bbc.js"><link rel="prefetch" href="/assets/js/24.0fc50092.js"><link rel="prefetch" href="/assets/js/25.80aec79a.js"><link rel="prefetch" href="/assets/js/26.58b1d342.js"><link rel="prefetch" href="/assets/js/27.02d32204.js"><link rel="prefetch" href="/assets/js/28.dea24a12.js"><link rel="prefetch" href="/assets/js/29.bc784c72.js"><link rel="prefetch" href="/assets/js/3.48d4d9db.js"><link rel="prefetch" href="/assets/js/30.b157a7cd.js"><link rel="prefetch" href="/assets/js/31.714da500.js"><link rel="prefetch" href="/assets/js/32.a638026e.js"><link rel="prefetch" href="/assets/js/33.f8e07fd5.js"><link rel="prefetch" href="/assets/js/34.03f9c53d.js"><link rel="prefetch" href="/assets/js/35.28665f3d.js"><link rel="prefetch" href="/assets/js/36.adca17e4.js"><link rel="prefetch" href="/assets/js/37.597fc012.js"><link rel="prefetch" href="/assets/js/38.bc607e46.js"><link rel="prefetch" href="/assets/js/39.8c75f3d6.js"><link rel="prefetch" href="/assets/js/4.be4d99a2.js"><link rel="prefetch" href="/assets/js/40.efc4b537.js"><link rel="prefetch" href="/assets/js/41.8591200d.js"><link rel="prefetch" href="/assets/js/42.37ab9026.js"><link rel="prefetch" href="/assets/js/43.5214c699.js"><link rel="prefetch" href="/assets/js/44.7e93e219.js"><link rel="prefetch" href="/assets/js/45.142f4692.js"><link rel="prefetch" href="/assets/js/46.b55dd140.js"><link rel="prefetch" href="/assets/js/47.ab977a50.js"><link rel="prefetch" href="/assets/js/49.eddb05e6.js"><link rel="prefetch" href="/assets/js/5.2b71416d.js"><link rel="prefetch" href="/assets/js/50.72d0c8f6.js"><link rel="prefetch" href="/assets/js/51.bb7ae4d8.js"><link rel="prefetch" href="/assets/js/52.e6b92616.js"><link rel="prefetch" href="/assets/js/53.3bc89833.js"><link rel="prefetch" href="/assets/js/54.ae808bb2.js"><link rel="prefetch" href="/assets/js/55.251404ee.js"><link rel="prefetch" href="/assets/js/56.0ba477b8.js"><link rel="prefetch" href="/assets/js/57.ede22bac.js"><link rel="prefetch" href="/assets/js/58.32f725dc.js"><link rel="prefetch" href="/assets/js/59.2d5caa76.js"><link rel="prefetch" href="/assets/js/6.e33b825d.js"><link rel="prefetch" href="/assets/js/60.6de597a8.js"><link rel="prefetch" href="/assets/js/61.2fc781f9.js"><link rel="prefetch" href="/assets/js/62.9841a631.js"><link rel="prefetch" href="/assets/js/63.539efd3c.js"><link rel="prefetch" href="/assets/js/64.bc62d8d8.js"><link rel="prefetch" href="/assets/js/65.dbcc02a0.js"><link rel="prefetch" href="/assets/js/66.a0c559d9.js"><link rel="prefetch" href="/assets/js/67.551c9674.js"><link rel="prefetch" href="/assets/js/68.aa43b5b9.js"><link rel="prefetch" href="/assets/js/69.76de2915.js"><link rel="prefetch" href="/assets/js/7.19a7a50f.js"><link rel="prefetch" href="/assets/js/70.0f196ffd.js"><link rel="prefetch" href="/assets/js/71.29b59f64.js"><link rel="prefetch" href="/assets/js/72.bd67b977.js"><link rel="prefetch" href="/assets/js/73.290f5862.js"><link rel="prefetch" href="/assets/js/74.542e65ca.js"><link rel="prefetch" href="/assets/js/75.e6cf3b2e.js"><link rel="prefetch" href="/assets/js/76.156a0b26.js"><link rel="prefetch" href="/assets/js/8.b9e9af4f.js"><link rel="prefetch" href="/assets/js/9.b8c53a14.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f289ed6e.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Human0722's blog" class="logo"> <span class="site-name can-hide">Human0722's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/springframework/" class="nav-link">Spring Framework</a></li><li class="dropdown-subitem"><a href="/java/springboot/" class="nav-link">Spring Boot</a></li><li class="dropdown-subitem"><a href="/java/springcloud/" class="nav-link">Spring Cloud</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="408" class="dropdown-title"><a href="/cs" class="link-title">408</a> <span class="title" style="display:none;">408</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/network/ccna/" class="nav-link">CCNA</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/js" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Vue</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/js/vue/2/" class="nav-link">Vue2</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pages/japanese/" class="nav-link">日本语</a></div><div class="nav-item"><a href="/pages/nav/" class="nav-link">导航</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/Human0722/Human0722.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://avatars.githubusercontent.com/u/56247729"> <div class="blogger-info"><h3>Human0722</h3> <span>Gravity always win</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/springframework/" class="nav-link">Spring Framework</a></li><li class="dropdown-subitem"><a href="/java/springboot/" class="nav-link">Spring Boot</a></li><li class="dropdown-subitem"><a href="/java/springcloud/" class="nav-link">Spring Cloud</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="408" class="dropdown-title"><a href="/cs" class="link-title">408</a> <span class="title" style="display:none;">408</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/network/ccna/" class="nav-link">CCNA</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/js" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Vue</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/js/vue/2/" class="nav-link">Vue2</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pages/japanese/" class="nav-link">日本语</a></div><div class="nav-item"><a href="/pages/nav/" class="nav-link">导航</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/Human0722/Human0722.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/pages/8b90f5/" class="sidebar-link">Docker</a></li><li><a href="/pages/b85e15/" aria-current="page" class="active sidebar-link">Redis</a><ul class="sidebar-sub-headers"></ul></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/linux/#Linux" data-v-06225672>Linux</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/Human0722" target="_blank" title="作者" class="beLink" data-v-06225672>Xueliang</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-03-23</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Redis<!----></h1>  <div class="theme-vdoing-content content__default"><h3 id="redis数据类型及操作"><a href="#redis数据类型及操作" class="header-anchor">#</a> Redis数据类型及操作</h3> <h4 id="keys"><a href="#keys" class="header-anchor">#</a> keys</h4> <p><strong>keys *</strong> 查看当前库所有 key<br> <strong>exists key</strong> 判断某个 key 是否存在<br> <strong>type key</strong> 查看你的 key 是什么类型<br> <strong>del key</strong> 删除指定的 key 数据<br> <strong>unlink key</strong> 根据 value 选择非阻塞删除,仅将 keys 从 keyspace 元数据中删除,后续自动清理。<br> <strong>expire key 10</strong> 10 秒钟:为给定的 key 设置过期时间<br> <strong>ttl key</strong> 查看还有多少秒过期，-1 表示永不过期，-2 表示已过期<br> <strong>select</strong> 命令切换数据库<br> <strong>dbsize</strong> 查看当前数据库的 key 的数量<br> <strong>flushdb</strong> 清空当前库<br> <strong>flushall</strong> 通杀全部库</p> <h4 id="►string"><a href="#►string" class="header-anchor">#</a> ►String</h4> <blockquote><p>key=&gt;Value 结构， 值最大512M</p></blockquote> <p><strong>set KEY VALUE [EX|PX] [NX|XX]</strong><br> <strong>NX</strong> :当数据库中 key 不存在时，可以将 key-value 添加数据库<br> <strong>XX</strong> :当数据库中 key 存在时，可以将 key-value 添加数据库，与 NX 参数互斥<br> <strong>EX</strong> :key 的超时秒数<br> <strong>PX</strong> :key 的超时毫秒数，与 EX 互斥<br> <strong>get KEY</strong> 查询对应键值<br> <strong>append KEY VALUE</strong>将给定的value 追加到原值的末尾 strlen key获得值的长度<br> <strong>setnx KEY VALUE</strong>只有在 key 不存在时 设置 key 的值<br> <strong>incr KEY</strong>将 key 中储存的数字值增 1<br> <strong>decr KEY</strong>将 key 中储存的数字值减 1<br> <strong>incrby / decrby KEY STEP</strong> 将 key 中储存的数字值增减<br> <strong>mset key1 val1 key2 val2</strong> 同时设置多个值<br> <strong>setex KEY TIME VALUE</strong> 设置键值的同时，设置过期时间，单位秒</p> <h4 id="►list"><a href="#►list" class="header-anchor">#</a> ►list</h4> <blockquote><p>key=&gt;values list, 单键多值，底层双向链表。</p></blockquote> <p><strong>lpush/rpush key value1 value2 value3</strong> .... 从左边/右边插入一个或多个值</p> <p><strong>lpop/rpop key</strong> 从左边/右边吐出一个值。值在键在，值光键亡</p> <p><strong>rpoplpush key1 key2</strong> 从key1列表右边吐出一个值，插到key2列表左边<br> <strong>lrange key start stop</strong> 按照索引下标获得元素(从左到右)<br> <strong>lindex  key index</strong>按照索引下标获得元素(从左到右)<br> <strong>llen key</strong>获得列表长度<br> <strong>linsert key before value newvalue</strong>在value的后面插入newvalue插入值<br> <strong>lrem key n value</strong>从左边删除 n 个 value(从左到右)<br> <strong>lset key index value</strong>将列表 key 下标为 index 的值替换成 value</p> <h4 id="►set"><a href="#►set" class="header-anchor">#</a> ►set</h4> <blockquote><p>Redis 的 Set 是 string 类型的无序集合。它底层其实是一个 value 为 null 的 hash 表，所 以添加，删除，查找的复杂度都是 O(1) .</p></blockquote> <p><strong>sadd key value1 value2 .....</strong>
将一个或多个 member 元素加入到集合 key 中，已经存在的 member 元素将被忽略 smembers key取出该集合的所有值</p> <p><strong>sismember key value</strong>  判断集合 key 是否为含有该value 值，有 1，没有 0<br> <strong>scard key</strong> 返回该集合的元素个数<br> <strong>srem key val1 val2...</strong> 删除集合中的某个元素<br> <strong>spop key</strong> 随机从该集合中吐出一个值<br> <strong>srandmember key n</strong> 随机从该集合中取出 n 个值。不会从集合中删除<br> <strong>smove source destination value</strong> 把集合中一个值从一个集合移动到另一个集合<br> <strong>sinter key1 key2</strong>返回两个集合的交集元素<br> <strong>sunion key1 key2</strong>返回两个集合的并集元素<br> <strong>sdiff key1 key2</strong> 返回两个集合的差集元素(key1 中的，不包含 key2 中的)</p> <h4 id="►hash"><a href="#►hash" class="header-anchor">#</a> ►Hash</h4> <blockquote><p>Redis hash 是一个 string 类型的 field 和 value 的映射表，hash 特别适合用于存储对象。</p></blockquote> <p><strong>hset key field value</strong>给key集合中的 field键赋值value<br> <strong>hget key1 field</strong>从key1集合field取出 value<br> <strong>hmset key1 field1 value1 field2 value2...</strong> 批量设置 hash 的值<br> <strong>hexists key1 field</strong>查看哈希表 key 中，给定域 field 是否存在<br> <strong>hkeys key</strong>列出该 hash 集合的所有 field<br> <strong>hvals key</strong>列出该 hash 集合的所有 value<br> <strong>hincrby key field increment</strong>为哈希表 key 中的域 field 的值加上增量 1 -1<br> <strong>hsetnx key field value</strong>将哈希表 key 中的域 field 的值设置为 value ，当且仅当域 field 不存在</p> <h4 id="►sorted-set"><a href="#►sorted-set" class="header-anchor">#</a> ►sorted set</h4> <p><strong>zadd key score1 value1 score2 value2...</strong>
将 member 元素及其 score 值加入到有序集 key 当中<br> <strong>zrange key start stop [WITHSCORES]</strong>
返回有序集 key 中，下标在start stop之间的元素,带 WITHSCORES，可以让分数一起和值返回<br> <strong>zrangebyscore key minmax [withscores] [limit offset count]</strong>
返回有序集 key 中，所有 score 值介于 min 和 max 之间(包括等于 min 或 max )的成员。 有序集成员按 score 值递增(从小到大)次序排列。
<strong>zrevrangebyscore key maxmin [withscores] [limit offset count]</strong> 同上，改为从大到小排列。<br> <strong>zincrby key increment value</strong> 为元素的 score 加上增量 zrem key value删除该集合下，指定值的元素<br> <strong>zcount key min max</strong> 统计集合分数区间内的元素个数<br> <strong>zrank key value</strong>返回该值在集合中的排名，从 0 开始</p> <h4 id="bitmaps"><a href="#bitmaps" class="header-anchor">#</a> bitmaps</h4> <blockquote><p>实际上就是字符串，但是可以对位进行操作。</p></blockquote> <p><strong>setbit key offset value</strong> 设置某个偏移量的值为0或1<br> <strong>getbit key offset</strong> 获得某个偏移量的值
如可以使用 bitmaps 来记录用户某天是否登陆，使用这样的数据：<strong>setbit unique:users:20240212 8 1</strong> 来表示  id=8 的用户在这一天登录了<br> <strong>bitcount key [start end]</strong> 统计1的个数<br> <strong>bitop operation destkey key [key]</strong>  位操作key,保存结果到destkey中</p> <h4 id="hyperloglog"><a href="#hyperloglog" class="header-anchor">#</a> hyperloglog</h4> <blockquote><p>求集合中不重复元素个数</p></blockquote> <p>Redis HyperLogLog 是用来做基数统计的算法，HyperLogLog 的优点是，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定的、并且是很小 的。</p> <p>但是，因为 HyperLogLog 只会根据输入元素来计算基数，而不会储存输入元素 本身，所以 HyperLogLog 不能像集合那样，返回输入的各个元素。<br> <strong>pfadd key element [element]</strong> 添加<br> <strong>pfcount key [key]</strong> 计算近似基数<br> <strong>pfmerge destkey key [key]</strong> 合并HLL存储在destkey中</p> <h4 id="geospatial"><a href="#geospatial" class="header-anchor">#</a> geospatial</h4> <blockquote><p>地理坐标计算</p></blockquote> <p><strong>geoadd key longitude latitude member</strong> key是一系列坐标的名称，member是该点的名称<br> <strong>geopos key member</strong> 获得指定member的坐标<br> <strong>geodist key member1 member2 [m|km]</strong> 计算两个点的距离<br> <strong>georadius key longitude latitude radius m|km</strong> 从给定的中心点，找出给定的半径内的坐标点</p> <h3 id="redis的持久化"><a href="#redis的持久化" class="header-anchor">#</a> Redis的持久化</h3> <blockquote><p>将Redis内存中的数据同步到硬盘中，有 RDB和AOF两种方式。</p></blockquote> <h4 id="rdb方式"><a href="#rdb方式" class="header-anchor">#</a> RDB方式</h4> <p>RDB 是 Redis Database的缩写，是Redis定时持久化策略。触发时，父进程fork出一个子进程将内存中的数据写到临时文件中，完成后替换原来的RDB文件。
配置RDB文件的位置以及触发条件：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>dir /DIT/TO/RDB   # 默认为redis启动目录
dbfilename dump.rdb
save 3600 2     # 3600后至少有2个key发生变更才持久化
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>因为RDB的持久化条件，所以最后的数据是因为来不及持久化而丢失的。</p> <h4 id="aof方式"><a href="#aof方式" class="header-anchor">#</a> AOF方式</h4> <p>AOF是 Append Only File  的缩写，以日志的形式来记录写操作，恢复数据时Redis会读取重构数据。 当Redis接受到写操作时，会先放入 AOF缓冲区内，缓冲区根据t同步策略持久化到硬盘中。当AOF文件大小超过重写配置大小，会对AOF文件进行压缩。
配置AOF打开（默认关闭）：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>appendonly yes
appendfsync always  #每次操作都同步
appendfsync everysec # 每秒同步
appendfsync no ## 交给操作系统
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="几种缓存问题"><a href="#几种缓存问题" class="header-anchor">#</a> 几种缓存问题</h3> <h4 id="缓存击穿"><a href="#缓存击穿" class="header-anchor">#</a> 缓存击穿</h4> <p>（击穿是动词）缓存击穿是连续访问都无法命中缓存，直接访问数据库导致负载变高。如查询不存在的ID操作。可以使用对空值缓存、bitmaps白名单等方式解决。</p> <h4 id="缓存穿透"><a href="#缓存穿透" class="header-anchor">#</a> 缓存穿透</h4> <p>（穿透是形容词）缓存穿透是缓存存在，但是在key过期的瞬间涌入大量请求，直接访问数据库导致负载变高。即热点数据的实效问题。可以采用提前预加载，动态调整有效期或者加分布式锁来解决。</p> <h4 id="缓存雪崩"><a href="#缓存雪崩" class="header-anchor">#</a> 缓存雪崩</h4> <p>缓存雪崩是说key对应的数据存在，但是在Redis中过期，此时涌入大量请求导致数据库负载升高。 与缓存穿透不同的是，缓存穿透是单一的key,而雪崩时大量的key。解决办法是缓存失效时间错开，设置过期标识（提前量）并监视更新，使用锁或者队列更新。</p> <h3 id="主从复制"><a href="#主从复制" class="header-anchor">#</a> 主从复制</h3> <p>主从复制是配置多台Redis实现读写分离，使得整个系统更容易拓展和恢复。
<img src="/images/linux/redis/masterslavestruct.jpg" alt=""><br>
主从复制的搭建方式：首先以指定配置文件的方式启动多台Redis实例，通常需要修改配置文件中的PID，PORT，RDB文件参数值。然后登录SLAVE主机，通过设置命令 <code>slaveof masterIP masterPORT</code>来让该实例成为从服务器。  设置成功后可以使用命令 <code>info replication</code> 来查看主从信息。<br>
配置文件DEMO：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>include /myreids/redis.conf
pidfile /var/run/redis_6379.pid
port 6379
dbfilename dump6379.rdb
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>当主从关系建立之后，<br>
1、在主服务上写正常，在从服务上写报错。<br>
2、主服务宕机，重启即可；从服务宕机，需要重启后重新设置。</p> <h4 id="常用的三种模式"><a href="#常用的三种模式" class="header-anchor">#</a> 常用的三种模式</h4> <p>一主二从： 启动三个服务实例，其中一个Master实例，两个Slave实例。<br>
薪火相传： 链表形式，上一个Slave是下一个的Master<br>
反客为主： 当Master实例宕机后，在所有的Slave实例中，谁先执行 <code>slaveof no one</code>,谁就回升级成新的Master实例。</p> <h4 id="哨兵模式-sentinel"><a href="#哨兵模式-sentinel" class="header-anchor">#</a> 哨兵模式（sentinel）</h4> <p><strong>反客为主的自动版本</strong>，能够自动检测Master是否故障，然后自动决定一个Slave升级为Master。
配置方法：
1、启动三份实例，配置成一主二从。<br>
2、新建sentinel配置文件： sentinel.conf</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>sentinel monitor mymaster 127.0.0.1 6379 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>mymaster 为监控对象起的服务器名称， 1 为至少有多少个哨兵同意迁移的数量
3、 执行 <code>redis-sentinel /path/to/sentinel.conf</code> 完成。</p> <blockquote><p>当 Master 故障时，sentinel 根据 slave-priority 的值来决定将哪一个slave升级成master。slave-priority 配置在 redis.conf中，值越小优先级越高。</p></blockquote></div></div>  <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/8b90f5/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Docker</div></a> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/8b90f5/" class="prev">Docker</a></span> <!----></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/951395/"><div>
            DefineSprintBootStarter
            <!----></div></a> <span class="date">03-23</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/116190/"><div>
            Spring MVC 启动流程分析
            <!----></div></a> <span class="date">03-23</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/f409ah/"><div>
            GIS 基础知识- 坐标系、投影、EPSG:4326、EPSG:3857
            <!----></div></a> <span class="date">03-22</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:btainlee@outlook.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Human0722" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2024
    <span>Human0722 | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.1aae9113.js" defer></script><script src="/assets/js/2.7e1b7c98.js" defer></script><script src="/assets/js/48.dffc62f2.js" defer></script>
  </body>
</html>
